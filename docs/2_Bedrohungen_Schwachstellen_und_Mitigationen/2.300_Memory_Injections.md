# Speicherinjektionen (Memory Injections)

## 1. Einführung: Ausführung von Software im Arbeitsspeicher

Die Grundlage für das Verständnis von Speicherinjektionen ist die Erkenntnis, dass alle Software, einschliesslich Malware, im Arbeitsspeicher (Memory) ausgeführt werden muss. Bevor etwas vom Prozessor (CPU) verarbeitet werden kann, muss es von der Festplatte in den Arbeitsspeicher geladen werden.  
**"Nichts wird auf Ihrem Computer ausgeführt, es sei denn, es wird von der Festplatte geladen, läuft im Arbeitsspeicher und wird von Ihrer CPU verarbeitet."**  
Daher muss sich auch Malware irgendwie im Arbeitsspeicher befinden, um funktionieren zu können.

## 2. Komponenten im Arbeitsspeicher

Im Arbeitsspeicher finden sich zahlreiche laufende Prozesse und zugehörige Komponenten. Dazu gehören:

- **DLLs (Dynamic-Link Libraries)**: Diese sind besonders wichtig im Kontext von Windows-Systemen und eine häufige Zielscheibe für Injektionen.
- **Threads**: Ausführungseinheiten innerhalb eines Prozesses.
- **Puffer**: Speicherbereiche.
- **Speicherverwaltungsfunktionen**: Funktionen, die die Organisation des Speichers regeln.

## 3. Malware-Strategien zur Ausführung im Speicher

Malware hat grundsätzlich zwei Hauptmöglichkeiten, um im Arbeitsspeicher eines Computers aktiv zu werden:

1. **Als eigener Prozess**: Die Malware kann als eigenständiger, neuer Prozess im Arbeitsspeicher ausgeführt werden.
2. **Injektion in einen bestehenden Prozess**: Dies ist die gefährlichere und häufigere Methode, die als "Speicherinjektion" bezeichnet wird.  
   **"Die Malware kann einen bestehenden Prozess finden und sich mitten in diesen Prozess injizieren."**

## 4. Funktionsweise der Prozessinjektion

Jeder Prozess im Arbeitsspeicher hat eine definierte Start- und Endadresse. Eine Injektion bedeutet, dass die Malware ihren Code innerhalb dieses Adressbereichs platziert.  
**"Wenn Sie Malware in diesen Prozess injizieren wollten, müssten Sie sie irgendwo zwischen diesen beiden Adressen injizieren."**

## 5. Vorteile der Prozessinjektion für Malware

Die Injektion in einen bestehenden Prozess bietet der Malware erhebliche Vorteile:

- **Umgehung der Erkennung**: Da die Malware nicht als neuer, verdächtiger Prozess auftritt, kann sie  
  **"Erkennung durch Anti-Malware, die nur nach einem bösartigen Prozess sucht,"** vermeiden.
- **Rechteeskalation (Privilege Escalation)**: Einer der kritischsten Vorteile ist, dass die injizierte Malware die gleichen Rechte und Berechtigungen erbt, die der Zielprozess besitzt.  
  **"Dies bedeutet, dass es für die Malware ein sehr einfacher Weg ist, plötzlich eine Privilegeskalation oder höhere Rechte und Berechtigungen zu erhalten, als sie normalerweise auf diesem System hätte."**

## 6. DLL-Injektion als häufige Form

Die DLL-Injektion ist eine der **"häufigsten Formen der Malware-Injektion"**.

### Was ist eine DLL?

DLL steht für **Dynamic-Link Library**.  
Es ist **"effektiv ein Typ von ausführbarer Datei auf Ihrem System, den viele verschiedene Prozesse und Anwendungen verwenden können."**  
Sie enthalten Code und Ressourcen, die von mehreren Programmen gleichzeitig genutzt werden können.

### Ablauf der DLL-Injektion:

1. **Platzierung der bösartigen DLL**:  
   Zuerst muss der Angreifer die bösartige DLL auf einem Speicherort ablegen, auf den das System zugreifen kann.
2. **Referenzierung im Zielprozess**:  
   Der Angreifer platziert dann einen Pfad zu dieser bösartigen DLL oder einen Link dazu **"innerhalb des Zielprozesses"**.  
   Dies geschieht oft durch das Manipulieren der Art und Weise, wie der Prozess seine benötigten DLLs lädt.
3. **Laden der bösartigen DLL**:  
   Wenn der Zielprozess ausgeführt wird und den Punkt erreicht, an dem er eine Referenz auf diese spezielle DLL benötigt,  
   **"geht er auf die Festplatte, zieht die bösartige DLL herein, und sie wird in den Speicher geladen."**
4. **Ausführung der Malware**:  
   Sobald die bösartige DLL in den Speicher geladen ist, ist  
   **"die Malware nun auf diesem System aktiv."**  
   Obwohl die bösartige DLL nicht ursprünglich Teil der Anwendung war, wird sie durch diesen Mechanismus als integraler Bestandteil des Prozesses ausgeführt.

## Fazit

Speicherinjektionen, insbesondere DLL-Injektionen, stellen eine raffinierte und effektive Methode für Malware dar, um auf Systemen Fuss zu fassen und ihre bösartigen Absichten zu verfolgen.  
Sie ermöglichen es der Malware:

- die Erkennung zu umgehen  
- von den Privilegien bestehender, vertrauenswürdiger Prozesse zu profitieren  

…was eine erhebliche Bedrohung für die Systemsicherheit darstellt.
---
QUELLE: https://www.youtube.com/watch?v=kBcTczu8FsM&list=PLG49S3nxzAnl4QDVqK-hOnoqcSKEIDDuv&index=26
