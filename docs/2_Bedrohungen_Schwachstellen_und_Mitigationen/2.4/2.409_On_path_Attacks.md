# On-Path-Angriffe (Man-in-the-Middle)

**Datum:** 26. Oktober 2023\
**Quelle:** Auszüge aus *"On-Path Attacks -- CompTIA Security+ SY0-701
-- 2.4"*

------------------------------------------------------------------------

## 1. Überblick über On-Path-Angriffe (Man-in-the-Middle)

Ein **On-Path-Angriff** (Man-in-the-Middle, MitM) ermöglicht es einem
Angreifer, sich **zwischen zwei kommunizierende Geräte** zu
positionieren. Der gesamte Datenverkehr kann so **überwacht oder
manipuliert** werden.

-   **Kernfunktion:** Angreifer sitzt zwischen zwei Geräten und
    beobachtet den gesamten Datenverkehr.\
-   **Unsichtbarkeit:** Für die Opfer ist der Angriff unsichtbar, sie
    bemerken ihn nicht.\
-   **Manipulation:** Neben dem passiven Mitlesen kann der Angreifer
    Daten in Echtzeit verändern.

------------------------------------------------------------------------

## 2. ARP-Poisoning (ARP-Spoofing) als Beispiel

Eine klassische On-Path-Technik innerhalb lokaler Netze ist
**ARP-Poisoning**.

### Eigenschaften

-   **Lokale Beschränkung:** Angreifer muss sich im gleichen Subnetz
    befinden.\
-   **Unsichere Basis:** ARP (Address Resolution Protocol) besitzt keine
    Authentifizierung und keine Verschlüsselung.

### Funktionsweise von ARP

1.  Ein Gerät fragt per Broadcast nach: „Wer ist 192.168.1.1?"\
2.  Der Router antwortet mit seiner MAC-Adresse.\
3.  Das Gerät speichert die Zuordnung in einem **ARP-Cache**.

### Angriffsprozess

1.  Angreifer sendet gefälschte ARP-Antworten an den Laptop („Ich bin
    192.168.1.1").\
2.  Laptop aktualisiert seinen Cache und ordnet die Router-IP der MAC
    des Angreifers zu.\
3.  Gleichzeitig täuscht der Angreifer auch den Router („Ich bin der
    Laptop").\
4.  Ergebnis: Der gesamte Datenverkehr läuft **über das Gerät des
    Angreifers**.

### Mögliche Aktionen des Angreifers

-   Datenverkehr überwachen (Sniffing)\
-   Inhalte manipulieren (z. B. Weiterleitung auf falsche Webseiten)\
-   Verbindungen unterbrechen (DoS)

------------------------------------------------------------------------

## 3. On-Path-Browser-Angriffe (Man-in-the-Browser)

Eine modernere Variante ist der **Man-in-the-Browser (MitB)**-Angriff.

### Eigenschaften

-   **Malware-basiert:** Trojaner oder Schadsoftware agiert als Proxy
    direkt im Browser.\
-   **Standort:** Angriff läuft lokal auf dem Endgerät.\
-   **Umgehung von Verschlüsselung:** Daten werden abgegriffen, bevor
    sie verschlüsselt oder nachdem sie entschlüsselt wurden.

### Ablauf

1.  Opfer meldet sich bei einer Webseite (z. B. Bank) an.\
2.  Malware erfasst Anmeldedaten (Benutzername, Passwort,
    Session-Tokens).\
3.  Angreifer kann im Hintergrund zusätzliche Sitzungen eröffnen, die
    das Opfer nicht sieht.\
4.  Aktionen: Überweisungen, Einkäufe oder Missbrauch der Anmeldedaten.

------------------------------------------------------------------------

## 4. Wichtige Fakten und Erkenntnisse

-   **Unsichtbarkeit:** Opfer merken meist nichts.\
-   **ARP-Poisoning:** Einfacher, da ARP unsicher ist und keine
    Authentifizierung vorsieht.\
-   **MitB-Angriffe:** Besonders gefährlich, da sie selbst
    **verschlüsselten Verkehr umgehen**.\
-   **Folgen:**
    -   Überwachung und Manipulation von Datenverkehr\
    -   Komplette Kontoübernahme\
    -   Finanzielle Schäden und Identitätsdiebstahl
---
QUELLE: https://www.youtube.com/watch?v=M_Af6_8JTuo&list=PLG49S3nxzAnl4QDVqK-hOnoqcSKEIDDuv&index=49
