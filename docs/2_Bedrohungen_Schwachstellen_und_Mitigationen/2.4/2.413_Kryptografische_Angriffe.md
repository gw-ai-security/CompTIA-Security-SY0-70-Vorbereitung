# Kryptographische Angriffe und Implementierungsschwächen

## 1. Einleitung: Die Rolle der Kryptographie und Angriffsvektoren
Kryptographie ist eine allgegenwärtige Technologie, deren Funktionsweise oft unbemerkt bleibt, aber für die **Vertraulichkeit, Integrität und Authentizität** von Daten entscheidend ist.  
Das zentrale Unterscheidungsmerkmal zwischen sicherer und unsicherer Kryptographie ist der **Schlüssel**:  

> „The piece of information that is the difference between something being secure and insecure is the key.“

Da Angreifer jedoch oft keinen direkten Zugang zu diesen Schlüsseln haben, konzentrieren sie sich auf alternative Methoden:  
- Angriffe auf die Algorithmen selbst (z. B. Hash-Kollisionen).  
- Angriffe auf die **Implementierung** kryptographischer Verfahren.  

Ein zentrales Prinzip lautet: **Algorithmen sind öffentlich**, um einer breiten Überprüfung standzuhalten. Nur solche Verfahren, die den „Test der Zeit“ bestehen, gelten als vertrauenswürdig. Werden Schwachstellen entdeckt, werden die betroffenen Algorithmen sofort als unsicher eingestuft:  

> „If we do find a workaround we immediately choose not to use that cryptography any longer.“

Heute liegt der Schwerpunkt vieler Angriffe weniger auf der Kryptographie selbst, sondern auf **Implementierungsfehlern**:  

> „It's the incorrect implementation of the cryptography that ultimately provides the weakest link.“

---

## 2. Angriffe auf kryptographische Algorithmen

### 2.1. Geburtstagsangriff (Birthday Attack) und Hash-Kollisionen
Der **Geburtstagsangriff** nutzt die Wahrscheinlichkeit von **Kollisionen** in Hash-Funktionen – analog zum bekannten Geburtstagsparadoxon:  
- Schon bei 23 Personen besteht eine ~50 % Chance, dass zwei den gleichen Geburtstag haben.  

Übertragen auf Kryptographie bedeutet dies:  
- Zwei unterschiedliche Eingaben (Plaintexts) können denselben Hashwert erzeugen (**Hash-Kollision**).  
- Kollisionen werden meist über Brute-Force-Suchen entdeckt.  

**Gegenmaßnahmen:**  
- Verwendung von Hash-Funktionen mit **großer Ausgabelänge** (z. B. SHA-256, SHA-3).  
- Ziel: Jeder unterschiedliche Plaintext erzeugt einen eindeutigen Hashwert.

---

### 2.2. Beispiel: MD5
- **MD5 (Message Digest Algorithm 5)** wurde 1992 veröffentlicht.  
- Bereits 1996 wurden Kollisionen entdeckt.  
- Im Jahr 2008 demonstrierten Forscher einen **praktischen Angriff**, bei dem ein gefälschtes **X.509-Zertifikat** von Browsern als legitim akzeptiert wurde, obwohl es manipuliert war.  

Zitat:  
> „A certificate from a CA that appeared legitimate when the MD5 hash was validated.“  

Dies führte zu einem sofortigen **Ausstieg aus MD5** und dem Übergang zu sicheren Verfahren wie **SHA-256**.  

Beispielhafte Demonstration: Zwei minimal unterschiedliche Klartexte erzeugten exakt denselben MD5-Hash.  
→ Dies gilt als klassische **Kollisionsattacke**.

---

## 3. Angriffe auf die Implementierung von Kryptographie

### 3.1. Downgrade-Angriff (Downgrade Attack)
Bei einem Downgrade-Angriff werden zwei Geräte, die eigentlich eine starke Verschlüsselung verwenden wollen, dazu gebracht, eine **schwächere oder gar keine Verschlüsselung** zu nutzen.  

Ziel:  
> „The two devices that are trying to send encrypted data [are forced] to either use a weaker encryption algorithm or not encrypt any of the data at all.“

---

### 3.2. SSL Stripping (HTTPS-Downgrade-Angriff)
**SSL Stripping** ist eine spezielle Form des Downgrade-Angriffs und ein Beispiel für einen **On-Path-Angriff (Man-in-the-Middle)**.  
Der Angreifer täuscht dem Opfer vor, dass keine HTTPS-Verbindung erforderlich sei, und zwingt es, **HTTP statt HTTPS** zu nutzen.

**Ablauf:**
1. **Initialer HTTP-Request:** Das Opfer ruft eine Seite per HTTP auf.  
2. **Server-Redirect:** Der Webserver möchte per Redirect auf HTTPS umleiten.  
3. **Angreifer fängt Umleitung ab:** Er verhindert, dass der Nutzer die HTTPS-Weiterleitung erhält.  
4. **Angreifer initiiert HTTPS-Verbindung:** Zum Webserver baut der Angreifer selbst eine sichere Verbindung auf.  
5. **Opfer bleibt bei HTTP:** Der Nutzer sieht eine unverschlüsselte Seite und überträgt Daten im Klartext.  
6. **Datendiebstahl:** Der Angreifer liest alle Daten (z. B. Login-Daten, Passwörter) im Klartext mit.  

Zitat:  
> „You don't need to request an encrypted form of the page. Simply send all of the data across the network without any type of encryption.“

---

## 4. Fazit
Die Sicherheit kryptographischer Systeme hängt nicht nur von der **Stärke der Algorithmen** ab, sondern maßgeblich auch von deren **korrekter Implementierung**.  

- **Angriffe auf Algorithmen:** Hash-Kollisionen (z. B. bei MD5) zeigen Schwächen der Verfahren selbst.  
- **Angriffe auf Implementierungen:** Downgrade-Angriffe (z. B. SSL Stripping) zeigen, wie auch robuste Verfahren wie TLS/SSL kompromittiert werden können, wenn die Umsetzung fehlerhaft ist.  

**Lehren:**  
- Nur sichere und getestete Algorithmen verwenden (SHA-2, SHA-3, AES).  
- Unsichere Verfahren (MD5, SHA-1, RC4) konsequent meiden.  
- Starke Konfigurationen erzwingen (TLS 1.2/1.3, HSTS, Perfect Forward Secrecy).  
- Regelmäßige Prüfungen von Implementierungen durchführen.  
---
QUELLE: https://www.youtube.com/watch?v=7aJaEQy6Yoc&list=PLG49S3nxzAnl4QDVqK-hOnoqcSKEIDDuv&index=52