# Anwendungsangriffe – CompTIA Security+ SY0-701 – 2.4

Dieses Dokument fasst die wesentlichen Konzepte und Angriffsarten zusammen, die im Rahmen der CompTIA Security+ SY0-701-Zertifizierung unter **Application Attacks (2.4)** behandelt werden.

---

## 1. Injektionsangriffe (Injection Attacks)

Injektionsangriffe gehören zu den häufigsten Methoden, eine Anwendung zu attackieren. Sie beruhen darauf, dass Angreifer **bösartigen Code in Eingaben einschleusen**, die von der Anwendung verarbeitet werden.

- **Grundproblem:** Die Anwendung prüft Eingaben nicht ausreichend.  
- **Zitat:**  
  > „An injection attack is a very common way to attack an application because an attacker can easily add additional malicious code to input that is going to a server or a client device. Normally this injection attack would be stopped by the application, but occasionally you'll find an application that does not provide the proper checks of any input going into the application.“  

- **Typen:**  
  - **SQL-Injektion (SQLi):** Die bekannteste Form.  
  - **Weitere Varianten:** HTML, XML, LDAP oder andere Datenformate.

---

## 2. Pufferüberlauf (Buffer Overflow)

Ein Pufferüberlauf tritt auf, wenn mehr Daten in einen für eine Variable vorgesehenen Speicherbereich geschrieben werden, als dieser aufnehmen kann. Die überschüssigen Daten „überlaufen“ in angrenzende Speicherbereiche.

- **Grundproblem:** Fehlende Eingabevalidierung.  
- **Zitat:**  
  > „With a buffer overflow you're adding information into a particular area of memory reserved for a variable, but you're putting more information than that variable can hold, and the extra data overflows into the buffer of memory that is next to this variable.“  

- **Schwierigkeit und Auswirkungen:**  
  - Schwierig zu erkennen und zu exploitieren, da speicher- und anwendungsspezifisch.  
  - Führt oft nur zu Abstürzen.  
  - Kann aber bei wiederholbarer Ausnutzung zu **Remote Code Execution (RCE)** führen.

---

## 3. Replay-Angriffe (Replay Attacks)

Replay-Angriffe basieren darauf, dass Angreifer **legitime Kommunikationsdaten erneut an einen Server senden**, um unberechtigten Zugang zu erhalten.

- **Herausforderung:** Die richtigen Daten abzufangen.  
- **Methoden:**  
  - Netzwerk-Mitschnitt (z. B. via Network Tap, ARP-Spoofing).  
  - Installation von Malware beim Opfer.  

- **Zielobjekte:**  
  - Benutzername und Passwort-Hash.  
  - Session-IDs.  

- **Kombination:** Häufig in Verbindung mit **On-Path-Angriffen (MITM)**, um Daten zu sammeln.

---

## 4. Privilegieneskalation (Privilege Escalation)

Privilegieneskalation beschreibt die **Ausweitung von Berechtigungen innerhalb eines Systems**.

- **Ziel:** Erlangung von Administrator- oder Systemrechten.  
- **Ursache:** Ausnutzung von Bugs oder bekannten Schwachstellen.  
- **Zitat:**  
  > „If there is a known vulnerability in this application or a bug that they can take advantage of, they may be able to get privilege escalation.“  

- **Typen:**  
  - **Vertikal:** Von normalen Benutzerrechten zu Administratorrechten.  
  - **Horizontal:** Zugriff auf Daten oder Rechte anderer Benutzer mit gleichem Privilegienlevel.  

- **Gegenmaßnahmen:**  
  - Schnelles Patchen von Schwachstellen.  
  - Aktualisierte Antiviren-/Antimalware-Signaturen.  
  - **DEP (Data Execution Prevention):** Schutz vor Ausführung von Code in bestimmten Speicherbereichen.  
  - **ASLR (Address Space Layout Randomization):** Erschwert Vorhersage von Speicheradressen.  

- **Beispiel:** **CVE-2023-29336** – Win32k Elevation of Privilege Vulnerability.  
  - Betraf den Win32k-Kernel-Treiber in Windows 10 und Windows Server.  
  - Ermöglichte Erlangung von **Systemprivilegien** (höchste Rechte).

---

## 5. Cross-Site Request Forgery (CSRF / XSRF)

Ein **CSRF-Angriff** zwingt eine bereits authentifizierte Website dazu, im Namen des Benutzers unerwünschte Aktionen auszuführen.

- **Kontext:**  
  Browser laden Inhalte von verschiedenen Servern (z. B. Videos von YouTube). Authentifizierung wird dabei nicht pro Ressource erneut geprüft.  

- **Trennung:**  
  - **Client-Seite:** Code im Browser (HTML, JavaScript).  
  - **Server-Seite:** Logik auf dem Webserver (z. B. PHP, Datenbank).  

- **Angriffsmechanismus:**  
  - Der Angreifer weiß, dass der Benutzer bereits eingeloggt ist (z. B. bei einer Bank).  
  - Ein manipuliertes Skript (meist in einem Link) wird vom Benutzer ausgeführt.  
  - Da der Browser die Session-Cookies mitsendet, führt der Server die Anfrage aus, als stamme sie vom legitimen Benutzer.  

- **Beispiel:**  
  Opfer klickt in eingeloggtem Zustand auf einen bösartigen Link, woraufhin unbemerkt eine Überweisung ausgeführt wird.  

- **Zitat:**  
  > „This attack exists because you've logged into a website and now that website trusts your browser. The attacker also knows that your browser is trusted, and they're hoping to have your browser make requests on their behalf to a server that is already trusted.“  

- **Gegenmaßnahmen:**  
  - **CSRF-Token (Anti-Forgery Token):** Jeder Request enthält ein einmaliges Token, das vom Server validiert wird.  
  - **SameSite-Cookies:** Einschränkung von Cookie-Übertragung über Drittseiten.  
  - Nutzeraufklärung (z. B. kein blindes Klicken auf Links).

---

## 6. Directory Traversal

**Directory Traversal (Path Traversal)** ermöglicht es, auf Dateien außerhalb des vorgesehenen Webserver-Verzeichnisses zuzugreifen.

- **Ursache:** Fehlkonfiguration oder Schwachstelle in Webserver/Applikation.  
- **Normal:** Zugriff nur auf Dateien innerhalb von `wwwroot` oder `htdocs`.  
- **Angriffsmechanismus:** Nutzung spezieller Zeichenfolgen wie `../`, um übergeordnete Verzeichnisse zu erreichen.  

- **Zitat:**  
  > „The dot dot slash is very indicative of a directory traversal because that is the command that allows you to move backwards one directory in that particular file system.“  

- **Beispiel:**  
  `www.example.com/show.asp?param=../../../../windows/system.ini`  
  → Zugriff auf sensible Windows-Dateien.  

- **Auswirkungen:**  
  - Lesen oder Manipulieren von Dateien außerhalb des Webroots.  
  - Potenzielle **Systemkompromittierung**.

---

## Fazit
Anwendungsangriffe nutzen typische Schwachstellen wie **fehlende Eingabevalidierung**, **ungenügende Speicherverwaltung**, **unsichere Sitzungsverwaltung** oder **Fehlkonfigurationen**.  

Die wichtigsten Gegenmaßnahmen sind:  
- Strikte Eingabevalidierung und sichere Programmierpraktiken.  
- Regelmäßiges Patch- und Schwachstellenmanagement.  
- Einsatz von Sicherheitsmechanismen wie DEP, ASLR und CSRF-Token.  
- Monitoring von Logdateien und Erkennen verdächtiger Muster (`../` im Pfad, Replay-Indikatoren).  
