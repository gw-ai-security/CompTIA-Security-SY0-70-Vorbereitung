# Angriffe durch Replay und Session Hijacking

Dieses Dokument bietet einen Überblick über Replay-Angriffe, **Pass-the-Hash-Angriffe** und **Session Hijacking**, basierend auf den bereitgestellten Informationen aus *"Replay Attacks – CompTIA Security+ SY0-701 – 2.4"*. Es beleuchtet die Funktionsweise dieser Angriffe, die Methoden zur Datensammlung durch Angreifer und präventive Maßnahmen.

---

## 1. Replay-Angriffe

Replay-Angriffe beinhalten das **Abfangen und Wiederverwenden** legitimer Netzwerkkommunikationen durch einen Angreifer, um sich als legitimer Nutzer auszugeben.

- **Grundlagen der Netzwerkkommunikation:**  
  Normalerweise verläuft der Datenverkehr zwischen Client und Server in beide Richtungen. Diese Kommunikation kann sensible Informationen enthalten, die ein Angreifer abfangen und später wiederverwenden möchte.

- **Ablauf eines Replay-Angriffs:**  
  - **Datensammlung:** Der Angreifer sammelt verwertbare Informationen. Dies kann durch physisches Netzwerk-Tapping, ARP-Spoofing (zur Umleitung des Verkehrs) oder durch Malware auf dem Opfergerät geschehen.  
  - **Wiedergabe:** Die abgefangenen Daten werden an den Server zurückgesendet. Dadurch kann sich der Angreifer als Opfer ausgeben.

- **Beziehung zu On-Path-Angriffen:**  
  Der Replay-Angriff selbst ist **kein On-Path-Angriff**, jedoch werden On-Path-Angriffe (Man-in-the-Middle) häufig genutzt, um die benötigten Daten abzugreifen.

- **Präventionsmaßnahmen:**  
  - **Verschlüsselung (Encryption):** Schutz des Datenverkehrs, sodass abgefangene Informationen unbrauchbar sind.  
  - **Salted Passwörter:** Jedes Login verwendet einen anderen Hash. Server können so konfiguriert werden, dass identische Hashes nicht mehrfach akzeptiert werden.

---

## 2. Pass-the-Hash-Angriffe

Pass-the-Hash ist eine spezielle Form des Replay-Angriffs, die auf **Passwort-Hashes** abzielt.

- **Funktionsweise:**  
  1. Ein Client sendet im Rahmen der Authentifizierung einen Benutzernamen und den Hash des Passworts.  
  2. Der Angreifer fängt diesen Verkehr ab und erlangt Benutzernamen + Hash.  
  3. Mit diesen Daten kann er sich erneut beim Server anmelden, ohne das Passwort selbst zu kennen.  

- **Ergebnis:**  
  Der Angreifer erhält Zugriff, da der Server den Hash als korrekt akzeptiert.

- **Präventionsmaßnahmen:**  
  - Dieselben Maßnahmen wie bei Replay-Angriffen: Verschlüsselung, Hash-Salting, zusätzlich **Multifaktor-Authentifizierung (MFA)** und **Token-Bindung**.

---

## 3. Session Hijacking (Side-Jacking)

Session Hijacking bedeutet, dass ein Angreifer eine **bestehende Benutzersitzung kapert**, indem er eine gültige Session-ID erlangt.

- **Browser-Cookies als Ziel:**  
  Cookies enthalten u. a. Sitzungsinformationen. Sie sind nicht bösartig, können jedoch wertvolle Informationen wie **Session-IDs** enthalten.

- **Datenschutzrisiko:**  
  Cookies können Benutzernamen oder weitere Details enthalten, die Angreifer für Identitätsdiebstahl nutzen.

- **Ablauf von Session Hijacking:**  
  1. Benutzer authentifiziert sich beim Webserver.  
  2. Der Server sendet eine **Session-ID** an den Client.  
  3. Angreifer fängt die Session-ID ab.  
  4. Mit dieser ID kann er Anfragen stellen, die der Server als legitim akzeptiert.  

- **Methoden zur Erfassung von Session-IDs:**  
  - **Paketerfassung (Sniffing):** z. B. mit Wireshark oder Kismet.  
  - **Client-seitige Exploits:** z. B. Cross-Site Scripting (XSS).  
  - **Modifikation von Headern:** mit Tools wie Tamper, Firesheep oder Scapy.  
  - **Browser-Erweiterungen:** Anzeigen und Manipulation gespeicherter Cookies.

- **Präventionsmaßnahmen:**  
  - **End-to-End-Verschlüsselung (HTTPS):** schützt Session-IDs und persönliche Daten.  
  - **Browser-Erweiterungen:** erzwingen verschlüsselte Verbindungen.  
  - **VPNs:** schützen zumindest den Teil der Kommunikation zwischen Client und VPN-Konzentrator.  
  - **Sichere Session-Management-Praktiken:** kurze Session-Lebensdauer, Re-Authentication, Bindung der Session an IP/Device.

---

## Fazit

Replay-Angriffe, Pass-the-Hash und Session Hijacking sind ernsthafte Bedrohungen, die auf **unzureichend geschützte Kommunikationswege** und **schwache Sitzungsmechanismen** abzielen.  
Die effektivsten Gegenmaßnahmen sind:  

- Durchgängige Verschlüsselung (z. B. HTTPS, VPN, TLS, IPsec)  
- Gesalzene und gestreckte Passwort-Hashes  
- Einsatz von Multifaktor-Authentifizierung  
- Robuste Sicherheitsmaßnahmen beim Session-Management  
---
QUELLE: https://www.youtube.com/watch?v=ai6qS13gKRo&list=PLG49S3nxzAnl4QDVqK-hOnoqcSKEIDDuv&index=49
