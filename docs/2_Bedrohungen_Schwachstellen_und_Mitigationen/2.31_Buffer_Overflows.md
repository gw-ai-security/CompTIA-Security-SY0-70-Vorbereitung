# Pufferüberläufe – Eine Analyse

## 1. Einleitung

Dieses Dokument fasst die Kernkonzepte und Mechanismen von Pufferüberläufen zusammen, wie sie in den bereitgestellten Auszügen aus "Buffer Overflows - CompTIA Security+ SY0-701 - 2.3" beschrieben werden. Pufferüberläufe stellen eine kritische Schwachstelle dar, die von Angreifern ausgenutzt werden kann, um unbefugten Zugriff oder erweiterte Privilegien in Anwendungen zu erlangen.

## 2. Was ist ein Pufferüberlauf?

Ein Pufferüberlauf ist eine Angriffsform, bei der ein Angreifer mehr Daten in einen Speicherbereich schreibt, als dieser aufnehmen kann.

> "A buffer overflow attack is one, where an attacker can write more than what is expected into a particular area of memory."

Diese überschüssigen Daten "überfliessen" dann in benachbarte Speicherbereiche. Normalerweise sollen Anwendungsentwickler durch sogenannte "Bounds Checking" sicherstellen, dass solche Überläufe verhindert werden. Hierbei wird überprüft, ob die geschriebenen Daten die vorgesehene Grösse (z.B. 8 Bytes) nicht überschreiten.

## 3. Schwierigkeit und Ziele der Ausnutzung

Die Ausnutzung von Pufferüberläufen ist keine einfache Aufgabe.

> "However, this is not a simple vulnerability to be able to exploit."

Das Hinzufügen von zusätzlichen Informationen zum Speicher kann unvorhergesehene Auswirkungen haben und dazu führen, dass das gesamte System oder die Anwendung abstürzt. Das Ziel eines Angreifers ist es, einen Pufferüberlauf zu finden, der:

- **Wiederholbar ist**: Der Angriff muss konsistent funktionieren.  
  > "What the attacker is really looking for is a buffer overflow that is always repeatable."
- **Vorteilhaft ist**: Er muss dem Angreifer eine bestimmte Funktion oder einen Vorteil verschaffen.  
  > "And it always is providing the attacker with a particular function that provides them with an advantage."

Häufiges Ziel ist das Erlangen von erhöhten Rechten und Berechtigungen.

## 4. Beispiel für einen Pufferüberlauf: Erlangen von Administratorrechten

Die Quelle illustriert einen detaillierten Fall, in dem ein Angreifer Pufferüberläufe nutzt, um administrative Rechte zu erlangen.

### 4.1. Ausgangssituation

- **Variable A**: Ein Speicherbereich von 8 Bytes, der aktuell leer ist (alle 0en).  
- **Variable B**: Ein Speicherbereich von 2 Bytes, der bereits beschrieben wurde und den Dezimalwert 1979 enthält.  
- **Rechteverwaltung**: Für diese Anwendung bestimmt der Wert von Variable B die Rechte und Berechtigungen:  
  - Werte unter 2000 bedeuten Benutzer- oder Gastrechte.  
  - Werte über 24000 bedeuten Administratorrechte.  
- **Normalzustand**: Variable B kann normalerweise nicht direkt innerhalb der Anwendung geändert werden.

### 4.2. Die Schwachstelle und der Angriff

Der Angreifer entdeckt eine Schwachstelle bei Variable A, die es ermöglicht, einen Pufferüberlauf auszuführen.

- Der Angreifer weiss, dass er 9 Bytes in Variable A schreiben kann.
- Dies füllt die 8 vorgesehenen Bytes von Variable A.
- Das 9. Byte überfliesst in den ersten Bytebereich von Variable B.

> "The attacker knows that they can use 9 bytes into variable A. And That will fill up the 8 bytes of what normally would be variable A. And it will overflow that last byte into variable B."

### 4.3. Konkretes Beispiel: "excessive"

- Der Angreifer wählt das Wort **"excessive"** (9 Zeichen), um es in Variable A zu speichern.
- Die ersten 8 Zeichen werden in Variable A gespeichert.
- Das 9. Zeichen, **'E'** (Hexadezimalwert **65**), überfliesst als erstes Byte in Variable B.

> "The ninth letter E, which is also the same as hex value 65, is stored as the first byte of variable B as it overflows into that particular variable."

### 4.4. Ergebnis

Durch diesen Überlauf ändert sich der Wert von Variable B drastisch. Der ursprüngliche Wert von 1979 wird zu **25856**.

> "You can see that this buffer flow has now changed the value of variable B. And now, its value is 25,856."

Da 25856 über 24000 liegt, erhält der Angreifer Administratorrechte für die Anwendung, ohne die üblichen Anmeldedaten eines Administrators zu besitzen.

> "This attacker was effectively able to use a buffer overflow to provide elevated rights and permissions for this application without having any type of credentials as an administrator."

## 5. Schlussfolgerung

Pufferüberläufe sind ernstzunehmende Sicherheitslücken, die, obwohl ihre Ausnutzung komplex sein kann, einem Angreifer ermöglichen, kritische Systemfunktionen zu manipulieren und erweiterte Privilegien zu erlangen. Die dargestellte Fallstudie verdeutlicht die potentielle Gefahr, die von solchen Schwachstellen ausgeht, wenn die Entwickler keine ausreichende **Bounds Checking** implementieren.
---
QUELLE: https://www.youtube.com/watch?v=0-qeeI5jTqU&list=PLG49S3nxzAnl4QDVqK-hOnoqcSKEIDDuv&index=27
